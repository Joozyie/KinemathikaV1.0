@* Views/Teacher/Dashboard.cshtml *@
@* WHAT IT DOES: Adds topbar with Logout, uses the shared sidebar, and shows tabs *@
@model Kinemathika.ViewModels.Teacher.TeacherDashboardVm
@{
    ViewData["IsAuthPage"] = true;
    ViewData["Title"] = "Teacher Dashboard";
    var sidebar = (SidebarVm)ViewBag.Sidebar;
}
<div class="container-xxl py-3">

    <!-- Top bar -->
    <div class="d-flex align-items-center justify-content-between mb-3">
        <div class="fw-semibold">Dashboard</div>
        <a class="btn btn-outline-danger" asp-controller="Account" asp-action="Login">Logout</a>
    </div>

    <div class="row g-4">
        <!-- Sidebar -->
        <div class="col-12 col-lg-3">
            @await Html.PartialAsync("~/Views/Shared/_TeacherSidebar.cshtml", Model.Sidebar)
        </div>

        <!-- Main -->
        <div class="col-12 col-lg-9">
            <div class="card border-0 shadow-sm rounded-4">
                <div class="card-body">
                    <ul class="nav nav-tabs mb-3">
                        <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-students">Students</a></li>
                        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-reports">Reports</a></li>
                    </ul>

                    <div class="tab-content">
                        <!-- Students tab -->
                        <div class="tab-pane fade show active" id="tab-students">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <div class="fw-semibold">Students Information</div>
                                <div class="input-group" style="max-width: 280px;">
                                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                                    <input class="form-control" placeholder="Search students">
                                </div>
                            </div>

                            <div class="table-responsive rounded-3">
                                <table class="table align-middle mb-0">
                                    <thead class="table-success">
                                        <tr><th>Student ID</th><th>Student Name</th><th>Email Address</th></tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var s in Model.Students)
                                        {
                                            <tr><td>@s.StudentId</td><td>@s.Name</td><td>@s.Email</td></tr>
                                        }
                                    </tbody>
                                </table>
                            </div>

                            <div class="row g-3 mt-3">
                                @foreach (var c in Model.Classes)
                                {
                                    <div class="col-md-6 col-12">
                                        <div class="border rounded-3 p-3">
                                            <div class="d-flex justify-content-between">
                                                <div class="fw-semibold">@c.Name</div>
                                                <span class="badge bg-success-subtle text-success">@c.StudentCount</span>
                                            </div>
                                            <div class="small text-muted">Average Accuracy</div>
                                            <div class="progress mb-1" style="height:10px;">
                                                <div class="progress-bar bg-success" style="width:@(c.AverageAccuracy * 100m)%"></div>
                                            </div>
                                            <div class="small">Avg Time Spent: @c.AvgTimeSpent</div>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>

                        <!-- Reports tab -->
                        <div class="tab-pane fade" id="tab-reports">
                            <div class="fw-semibold mb-2">Overall Statistics</div>
                            <div class="d-flex align-items-end gap-3" style="height:220px;">
                                @for (int i = 0; i < Model.Report.Bars.Count; i++)
                                {
                                    var h = Model.Report.Bars[i];
                                    <div class="text-center">
                                        <div style="width:48px; height:@h% ; background:#198754; border-radius:.5rem .5rem 0 0;"></div>
                                        <div class="small mt-1 text-muted" style="width:60px;">@Model.Report.Labels[i]</div>
                                    </div>
                                }
                            </div>
                        </div>
                    </div> <!-- /tab-content -->
                </div>
            </div>
        </div>
    </div>
</div>
